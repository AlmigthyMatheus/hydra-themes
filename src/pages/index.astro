---
import Layout from "../layouts/Layout.astro";
import { ThemeList } from "@/components/ui/theme-list";
import themeList from "@/lib/themes.json";

import { redis } from "@/lib/redis";

const themes = await Promise.all(
  themeList.map(async (theme) => {
    const themeData = await redis.get(`theme:${theme.id}`).then((data) => {
      if (!data) return { downloads: 0, favorites: 0 };
      return JSON.parse(data);
    });

    return { ...theme, ...themeData };
  }),
);
---

<Layout title="Hydra Themes">
  <ThemeList client:load themes={themes} />
</Layout>
